var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);n.prototype=e.prototype,t.prototype=new n},__decorate=this&&this.__decorate||function(t,e,n,o){var i,r=arguments.length,a=3>r?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(3>r?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},__awaiter=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function a(t){try{c(o.next(t))}catch(e){r(e)}}function s(t){try{c(o["throw"](t))}catch(e){r(e)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}c((o=o.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function n(t){return function(e){return o([t,e])}}function o(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,r&&(a=r[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(r,n[1])).done)return a;switch(r=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,r=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=e.call(t,c)}catch(o){n=[6,o],r=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,r,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},vitamin;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.create(),t}return __extends(n,e),Object.defineProperty(n.prototype,"name",{get:function(){return this.$name},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ads",{get:function(){return this.$ads},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rankDialog",{get:function(){return this.$rankDialog},enumerable:!0,configurable:!0}),n.prototype.create=function(){},n.prototype.get=function(e){return t.ObjectUtil.instance(t.LocalStorage).get(e)},n.prototype.set=function(e,n){return t.ObjectUtil.instance(t.LocalStorage).set(e,n)},n.prototype.notifyState=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n]},n.prototype.getFromRank=function(t){return Promise.resolve()},n.prototype.login=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Promise.resolve(!1)},Object.defineProperty(n.prototype,"asMini",{get:function(){return this instanceof t.PMini?this:null},enumerable:!0,configurable:!0}),n}(egret.EventDispatcher);t.PBase=e,__reflect(e.prototype,"vitamin.PBase")}(vitamin||(vitamin={}));var vitamin;!function(t){function e(e){return function(n){t.__platforms[e]=n}}function n(e){return function(n){t.__ads[e]=n}}var o;!function(t){t.Debug="debug",t.FACEBOOK="facebook",t.GOOGLE="google",t.WXGAME="wxgame",t.BYTEDANCE="ttgame"}(o=t.TypePlatform||(t.TypePlatform={}));var i;!function(t){t[t.Loading=0]="Loading",t[t.Loaded=1]="Loaded"}(i=t.TypePlatState||(t.TypePlatState={}));var r=function(){function t(){}return t.NONE=0,t.RECORDING=1,t.RECORDED=2,t}();t.StateRecord=r,__reflect(r.prototype,"vitamin.StateRecord"),t.WordRankTestData=[{rank:1,uid:"1",name:"狸哩亽喵",score:3545531,headurl:"resource/test/1.jpg",ismine:!1},{rank:2,uid:"2",name:"啃骨头的喵呜",score:3508732,headurl:"resource/test/2.jpg",ismine:!1},{rank:3,uid:"3",name:"蘑菇头女孩",score:2835571,headurl:"resource/test/3.jpg",ismine:!1},{rank:4,uid:"4",name:"梦幻の蝴蝶",score:1534512,headurl:"resource/test/4.jpg",ismine:!0},{rank:5,uid:"5",name:"樱野猫少女",score:1234534,headurl:"resource/test/5.jpg",ismine:!1},{rank:6,uid:"6",name:"ω糖果罐子",score:834341,headurl:"resource/test/6.jpg",ismine:!1},{rank:7,uid:"7",name:"萌妹妹哟",score:754621,headurl:"resource/test/7.jpg",ismine:!1},{rank:8,uid:"8",name:"夢中ら情人",score:695444,headurl:"resource/test/8.jpg",ismine:!1},{rank:9,uid:"9",name:"无暇阿萌",score:565888,headurl:"resource/test/9.jpg",ismine:!1},{rank:10,uid:"10",name:"神经质萌妞",score:559888,headurl:"resource/test/10.jpg",ismine:!1}],t.FriendRankTestData=[{rank:1,uid:"1",name:"桃子果冻ゝ",score:653541,headurl:"resource/test/1.jpg",ismine:!1},{rank:2,uid:"2",name:"好姑涼光芒萬丈",score:607407,headurl:"resource/test/2.jpg",ismine:!1},{rank:3,uid:"3",name:"猫一样的小女人",score:536211,headurl:"resource/test/3.jpg",ismine:!1},{rank:4,uid:"4",name:"look°有灰机",score:356511,headurl:"resource/test/4.jpg",ismine:!1},{rank:5,uid:"5",name:"崽崽酱   ",score:262121,headurl:"resource/test/5.jpg",ismine:!1},{rank:6,uid:"6",name:"风铃鹿",score:223240,headurl:"resource/test/6.jpg",ismine:!1},{rank:7,uid:"7",name:"元気少女",score:197847,headurl:"resource/test/7.jpg",ismine:!0},{rank:8,uid:"8",name:"薰薰",score:135676,headurl:"resource/test/8.jpg",ismine:!1},{rank:9,uid:"9",name:"蓝鲸少女与猫",score:12374,headurl:"resource/test/9.jpg",ismine:!1},{rank:10,uid:"10",name:"森林迷了鹿",score:9972,headurl:"resource/test/10.jpg",ismine:!1}],t.__platforms={},t.__ads={},t.Platform=e,t.Ads=n}(vitamin||(vitamin={}));var vitamin;!function(t){var e;!function(t){t.UserInfo="scope.userInfo",t.UserLocation="scope.userLocation",t.Address="scope.address",t.Record="scope.record",t.Album="scope.album",t.Camera="scope.camera"}(e=t.PMiniAuthSetting||(t.PMiniAuthSetting={}));var n=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.recordState=0,t}return __extends(n,e),n.prototype.initialize=function(){return Promise.resolve()},n.prototype.getSetting=function(t){return Promise.resolve(null)},n.prototype.execSetting=function(t){return Promise.resolve(null)},n.prototype.getUserData=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Promise.resolve(null)},n.prototype.getFromRank=function(){return Promise.resolve()},n.prototype.setToRank=function(t,e,n){return Promise.resolve()},n.prototype.createDisplayObject=function(e,n,o,i,r){window.sharedCanvas.width=i,window.sharedCanvas.height=r,window.sharedCanvas.x=n,window.sharedCanvas.y=o;var a=new egret.BitmapData(window.sharedCanvas);a.$deleteSource=!1;var s=new egret.Texture;s._setBitmapData(a);var c=new egret.Bitmap(s);if(c.width=i,c.height=r,c.x=n,c.y=o,"webgl"==egret.Capabilities.renderMode){var l;switch(this.$name){case t.TypePlatform.WXGAME:l=egret.wxgame.WebGLRenderContext.getInstance();break;case t.TypePlatform.BYTEDANCE:l=egret.ttgame.WebGLRenderContext.getInstance()}var u=l.context;u.wxBindCanvasTexture||egret.startTick(function(t){return egret.WebGLUtils.deleteWebGLTexture(a.webGLTexture),a.webGLTexture=null,!1},this)}return this.postMessage("initialize",{x:n,y:o,width:t.stage.width,height:t.stage.height,canvasWidth:i,canvasHeight:r}),c},n.prototype.postMessage=function(e,n){n.command=e;var o;switch(this.$name){case t.TypePlatform.WXGAME:o=window.wx.getOpenDataContext();break;case t.TypePlatform.BYTEDANCE:o=window.tt.getOpenDataContext()}o.postMessage(n)},n.prototype.recordStart=function(t){},n.prototype.recordStop=function(){},n.prototype.recordHas=function(){return!1},n.prototype.recordPublish=function(t){},n.prototype.share=function(t){return Promise.resolve()},n.prototype.shareInvite=function(){return Promise.resolve()},n.prototype.shock=function(){},n.prototype.showcustomerButton=function(t,e,n,o){},n.prototype.hidecustomerButton=function(){},n.prototype.opencustomer=function(){},Object.defineProperty(n.prototype,"asWeChat",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"asBytes",{get:function(){return this},enumerable:!0,configurable:!0}),n}(t.PBase);t.PMini=n,__reflect(n.prototype,"vitamin.PMini")}(vitamin||(vitamin={}));var vitamin;!function(t){var e=function(){function t(){}return t.INSET_PAGE_LOAD_ERR="INSET_PAGE_LOAD_ERR",t.INSET_PAGE_LOADED="INSET_PAGE_LOADED",t.VIDEO_INSPIRE_LOAD_ERR="VIDEO_INSPIRE_LOAD_ERR",t.VIDEO_INSPIRE_LOADED="VIDEO_INSPIRE_LOADED",t}();t.AdsEvent=e,__reflect(e.prototype,"vitamin.AdsEvent");var n=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initialize=function(t){return this.$options=t,Promise.resolve()},e.prototype.showBanner=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.hideBanner=function(){},e.prototype.loadVideo=function(){},e.prototype.playVideo=function(t){},e.prototype.loadInterstitial=function(){},e.prototype.playInterstitial=function(t){},e.prototype.playMultitonVideo=function(t){},e}(egret.EventDispatcher);t.ADSBase=n,__reflect(n.prototype,"vitamin.ADSBase")}(vitamin||(vitamin={}));var vitamin;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.$name="Debug",t}return __extends(n,e),n.prototype.initialize=function(){return Promise.resolve()},n.prototype.getUserData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Promise.resolve(null)},n.prototype.setToRank=function(t){return Promise.resolve()},n.prototype.share=function(){return Promise.resolve()},n.prototype.shareInvite=function(){return Promise.resolve()},n.prototype.getWorldRank=function(){return Promise.resolve(t.WordRankTestData)},n.prototype.getFriendRank=function(){return Promise.resolve(t.FriendRankTestData)},n.prototype.shock=function(t){void 0===t&&(t=100),window&&window.navigator.vibrate&&(window.navigator.vibrate(0),window.navigator.vibrate(t))},n.prototype.opencustomer=function(){},n=__decorate([t.Platform(t.TypePlatform.Debug)],n)}(t.PBase);t.PDebug=e,__reflect(e.prototype,"vitamin.PDebug")}(vitamin||(vitamin={}));var vitamin;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.$name="PFaceBook",t}return __extends(n,e),n.prototype.initialize=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,FBInstant.initializeAsync()];case 1:return t.sent(),console.log("FB initialize!!"),[2,Promise.resolve()]}})})},n.prototype.notifyState=function(e,n){switch(e){case t.TypePlatState.Loading:FBInstant.setLoadingProgress(100*n);break;case t.TypePlatState.Loaded:FBInstant.setLoadingProgress(100),FBInstant.startGameAsync()}},n.prototype.getUserData=function(t,e){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(o){return n={uid:FBInstant.player.getID(),name:FBInstant.player.getName(),headurl:FBInstant.player.getPhoto()},e.call(t,n),[2,Promise.resolve(n)]})})},n.prototype.get=function(t){return FBInstant.player.getDataAsync([t])},n.prototype.set=function(t,e){return FBInstant.player.setDataAsync((n={},n[t]=e,n));var n},n.prototype.getWorldRank=function(){return __awaiter(this,void 0,void 0,function(){var e,n,o,i,r,a,s,c,l,u;return __generator(this,function(d){switch(d.label){case 0:return e="wrold",[4,FBInstant.getLeaderboardAsync(e)];case 1:return n=d.sent(),n?[4,n.getEntryCountAsync()]:(t.ui.tip("排行榜获取失败:"+e),[2,Promise.resolve(null)]);case 2:return o=d.sent(),[4,n.getEntriesAsync(o,0)["catch"](function(n){t.ui.tip("在应用程序配置中找不到排行榜“"+e+"”")})];case 3:return i=d.sent(),[4,n.getPlayerEntryAsync()];case 4:for(r=d.sent(),a=1,s=[],c=0,l=i;c<l.length;c++)u=l[c],s.push({rank:a++,uid:u.getPlayer().getID(),name:u.getPlayer().getName(),score:u.getScore(),headurl:u.getPlayer().getPhoto(),ismine:u.getPlayer().getID()==r.getPlayer().getID()});return[2,Promise.resolve(s)]}})})},n.prototype.getFriendRank=function(){return __awaiter(this,void 0,void 0,function(){var e,n,o,i,r,a,s,c,l,u,d;return __generator(this,function(p){switch(p.label){case 0:return(e=FBInstant.context.getID())?(n="friend."+e,[4,FBInstant.getLeaderboardAsync(n)]):[3,5];case 1:return o=p.sent(),o?[4,o.getEntryCountAsync()]:(t.ui.tip("排行榜获取失败:"+n),[2,Promise.resolve(null)]);case 2:return i=p.sent(),[4,o.getEntriesAsync(i,0)["catch"](function(e){t.ui.tip("在应用程序配置中找不到排行榜“"+n+"”")})];case 3:return r=p.sent(),[4,o.getPlayerEntryAsync()];case 4:for(a=p.sent(),s=1,c=[],l=0,u=r;l<u.length;l++)d=u[l],c.push({rank:s++,uid:d.getPlayer().getID(),name:d.getPlayer().getName(),score:d.getScore(),headurl:d.getPlayer().getPhoto(),ismine:d.getPlayer().getID()==a.getPlayer().getID()});return[2,Promise.resolve(c)];case 5:return[2,Promise.resolve(null)]}})})},n.prototype.setToRank=function(t){return __awaiter(this,void 0,void 0,function(){var e,n,o;return __generator(this,function(i){switch(i.label){case 0:return[4,FBInstant.getLeaderboardAsync("wrold")];case 1:return e=i.sent(),e?[4,e.setScoreAsync(t.score,JSON.stringify(t))]:[3,3];case 2:return i.sent(),console.log("排行榜",e.getName(),"Score saved"),[3,4];case 3:console.error("排行榜",e.getName(),"Score save error"),i.label=4;case 4:return(n=FBInstant.context.getID())?(o="friend."+n,[4,FBInstant.getLeaderboardAsync(o)]):[3,8];case 5:return e=i.sent(),e?[4,e.setScoreAsync(t.score,JSON.stringify(t))]:[3,7];case 6:return i.sent(),console.log(e.getName(),"Score saved"),[3,8];case 7:console.error(e.getName(),"Score save error"),i.label=8;case 8:return[2]}})})},n.prototype.notifyRankChange=function(){var t=FBInstant.context.getID();if(t){var e="friend."+t;FBInstant.updateAsync({action:"LEADERBOARD",name:e}).then(function(){return console.log("Update Posted")})["catch"](function(t){return console.error(t)})}},n.prototype.loadOver=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,FBInstant.setLoadingProgress(100)];case 1:return t.sent(),[2,Promise.resolve()]}})})},n.prototype.share=function(e){return __awaiter(this,void 0,void 0,function(){var n,o,i;return __generator(this,function(r){switch(r.label){case 0:return n={intent:"SHARE",image:null,text:"some fun wait for you :)"},e?(n.text=e.title,o="png",e.imageUrl?(o=t.Path.extname(e.imageUrl).substring(1),i=e,[4,t.res.loadRes(e.imageUrl,t.TypeRes.IMAGE)]):[3,2]):[3,3];case 1:i.image=r.sent(),r.label=2;case 2:e.image&&(n.image=e.image.toDataURL("image/"+o)),r.label=3;case 3:return[2,FBInstant.shareAsync(n)]}})})},n.prototype.shareInvite=function(){return Promise.resolve()},n.prototype.shareByInvite=function(e){return __awaiter(this,void 0,void 0,function(){var n,o,i;return __generator(this,function(r){switch(r.label){case 0:return n={intent:"INVITE",image:null,text:"some fun wait for you :)",data:{uid:FBInstant.player.getID()}},e?(n.text=e.title,o="png",e.imageUrl?(o=t.Path.extname(e.imageUrl).substring(1),i=e,[4,t.res.loadRes(e.imageUrl,t.TypeRes.IMAGE)]):[3,2]):[3,3];case 1:i.image=r.sent(),r.label=2;case 2:e.image&&(n.image=e.image.toDataURL("image/"+o)),r.label=3;case 3:return[2,FBInstant.shareAsync(n)]}})})},n.prototype.shock=function(t){},n.prototype.opencustomer=function(){},n=__decorate([t.Platform(t.TypePlatform.FACEBOOK)],n)}(t.PBase);t.PFaceBook=e,__reflect(e.prototype,"vitamin.PFaceBook")}(vitamin||(vitamin={}));var vitamin;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.$name="PGoogle",t}return __extends(n,e),n.prototype.initialize=function(){return Promise.resolve()},n.prototype.getUserData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Promise.resolve(null)},n.prototype.setToRank=function(t){return Promise.resolve()},n.prototype.share=function(){return Promise.resolve()},n.prototype.shareInvite=function(){return Promise.resolve()},n.prototype.shock=function(t){},n.prototype.opencustomer=function(){},n=__decorate([t.Platform(t.TypePlatform.GOOGLE)],n)}(t.PBase);t.PGoogle=e,__reflect(e.prototype,"vitamin.PGoogle")}(vitamin||(vitamin={}));var vitamin;!function(t){function e(e){var n=t.Config.platform?t.Config.platform:t.TypePlatform.Debug,o=t.__platforms[n];if(o){e||(e={});var i=e[n];if(t.platform=new o,t.platform.$name=n,t.platform.initialize(),t.warn("当前平台:"+n+",初始化参数:"+JSON.stringify(i)),i){for(var r in i)t.platform["$"+r]=i[r];if(i.ads){var a=t.__ads[n];a&&(t.platform.$ads=new a)}t.platform.ads?(t.platform.ads.initialize(i.ads),t.log("初始化广告组件")):t.warn("广告参数无效,未初始化广告组件")}return t.platform}}t.initializePlatform=e}(vitamin||(vitamin={}));var vitamin;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.$name="PWXGame",t}return __extends(n,e),n.prototype.initialize=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this.postMessage("loadAssets",{}),[2,Promise.resolve()]})})},n.prototype.get=function(t){return new Promise(function(e){wx.getStorage({key:t,success:function(t){e(t.data)},fail:function(){e(null)}})})},n.prototype.set=function(e,n){return new Promise(function(o){wx.setStorage({key:e,data:n,fail:function(e){return t.error(e)}})})},n.prototype.setToRank=function(e,n,o){var i={wxgame:{score:n,update_time:Date.now()/1e3>>0},ext:JSON.stringify(o)};return new Promise(function(n){var o=[{key:e,value:JSON.stringify(i)}];t.log("setUserCloudStorage:",o),wx.setUserCloudStorage({KVDataList:o,success:function(){n()},fail:function(e){return t.error(e)}})})},n.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(n){switch(n.label){case 0:return[4,this.checkSessionHandler()];case 1:return e=n.sent(),e?[2]:[2,new Promise(function(e,n){wx.login({success:function(n){t.log("登录成功"),e(!0)},fail:function(n){t.log("登录失败"),e(!1)}})})]}})})},n.prototype.getUserData=function(e,n){return __awaiter(this,void 0,void 0,function(){var n,o=this;return __generator(this,function(i){switch(i.label){case 0:return this.userInfo?[2,Promise.resolve(this.userInfo)]:(e||(e={}),[4,this.execAuthorize(t.PMiniAuthSetting.UserInfo)]);case 1:return n=i.sent(),n?[3,4]:[4,this.getSetting(t.PMiniAuthSetting.UserInfo)];case 2:if(n=i.sent())return[3,4];if(!e.checkSetting){try{wx.showToast({title:"用户信息未获授权,请重新触发授权!",icon:"warn",duration:3e3})}catch(r){}return e.complete&&e.complete.call(e.caller,null),[2]}return[4,this.execSetting(t.PMiniAuthSetting.UserInfo)];case 3:if(n=i.sent(),!n){console.error("未成功授权或用户放弃授权!");try{wx.showToast({title:"未成功授权或用户放弃授权!",icon:"fail",duration:3e3})}catch(r){}return[2]}i.label=4;case 4:return[2,new Promise(function(e,n){t.log("开始获取用户信息..."),wx.getUserInfo({complete:function(n){return n.errno?(t.log("用户信息获取失败:",n),void e(o.userInfo)):(t.log("用户信息获取成功:",n),o.wxuserInfo=n.userInfo,o.userInfo={uid:"",name:o.wxuserInfo.nickName,headurl:o.wxuserInfo.avatarUrl},void e(o.userInfo))}})})]}})})},n.prototype.showGetUserInfo=function(t,e){var n=this;this._userButton||(this._userButton=wx.createUserInfoButton({type:"text",text:"点击登录",style:{left:t.x,top:t.y,width:t.width,height:t.height,lineHeight:50,backgroundColor:"#20C263",color:"#ffffff",textAlign:"center",fontSize:18,borderRadius:16},withCredentials:!1})),this._userButtonTapHandler=function(){n.cancelGetUserInfo(),e()},this._userButton.show(),this._userButton.onTap(this._userButtonTapHandler)},n.prototype.cancelGetUserInfo=function(){this._userButton&&(this._userButton.offTap(this._userButtonTapHandler),this._userButton.hide())},n.prototype.checkSessionHandler=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,new Promise(function(e,n){wx.checkSession({success:function(n){t.log("session未过期"),e(!0)},fail:function(n){t.log("session已过期"),e(!1)}})})]})})},n.prototype.getSetting=function(t){return new Promise(function(e){wx.getSetting({scope:t,success:function(n){console.log("授权设置:",n);try{wx.showToast({title:"授权设置:"+n.authSetting[t],icon:"none",duration:1e3})}catch(o){}e(n.authSetting[t])},fail:function(t){console.error("获取授权信息失败");try{wx.showToast({title:"获取授权信息失败!",icon:"fail",duration:1e3})}catch(n){}e(null)}})})},n.prototype.execSetting=function(t){return new Promise(function(e){wx.openSetting({scope:t,success:function(n){console.log("用户授权设置:",n),e(n.authSetting[t])},fail:function(){console.error("执行授权失败");try{wx.showToast({title:"执行授权失败!",icon:"fail",duration:1e3})}catch(t){}e(null)}})})},n.prototype.execAuthorize=function(t){return new Promise(function(e){wx.authorize({scope:t,success:function(t){console.log("提前授权设置:",t),e(!0)},fail:function(){console.error("提前授权失败");try{wx.showToast({title:"提前授权失败!",icon:"fail",duration:1e3})}catch(t){}e(null)}})})},n.prototype.setUserGroup=function(){wx.setUserGroup({groupId:"world_group",success:function(t){console.log("SetGroup Success!")},fail:function(){console.log("SetGroup Fail!")}})},Object.defineProperty(n.prototype,"isLogin",{get:function(){return!!this.userInfo},enumerable:!0,configurable:!0}),n.prototype.recordStart=function(e){var n=this;this._startRecordTime=egret.getTimer();var o=wx.getGameRecorder();if(!o.isFrameSupported())return void t.ui.tip("当前不支持录制游戏画面.");o.start({duration:30}),o.on("stop",function(o){egret.getTimer()-n._startRecordTime<5e3?(t.ui.tip("录屏时间太短,录制无效!"),n.recordState=t.StateRecord.NONE,e&&e.fail&&e.fail.call(e.caller)):(n.recordState=t.StateRecord.RECORDED,e&&e.complete&&e.complete.call(e.caller))}),this.recordState=t.StateRecord.RECORDING},n.prototype.recordStop=function(){var e=wx.getGameRecorder();e.stop(),this.recordHas()||(this.recordState=t.StateRecord.NONE)},n.prototype.recordHas=function(){return this.recordState==t.StateRecord.RECORDED},n.prototype.recordPublish=function(t){this.createGameRecorderShareButton({text:t.title?t.title:"分享视频",icon:t.imageUrl})},n.prototype.createGameRecorderShareButton=function(e){var n=wx.createGameRecorderShareButton({style:{left:10,top:150,height:50,color:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4,iconMarginRight:16,paddingLeft:1,paddingRight:30},image:e.buttonimage,text:e.text,icon:e.icon,share:{query:"a=1&b=2",bgm:"walkin.mp3",timeRange:[[0,1e3],[2e3,3e3]],title:{template:"default.score",data:{score:6500}},button:{template:"default.enter"}}});return this.recordState=t.StateRecord.NONE,n},n.prototype.share=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return wx.shareAppMessage(t),[2,Promise.resolve()]})})},n.prototype.shareInvite=function(){return new Promise(function(t){wx.shareAppMessage({channel:"invite",success:function(e){t(e)}})})},n.prototype.shock=function(){wx.vibrateShort({success:function(t){},fail:function(t){console.log("vibrateShort调用失败")}})},n.prototype.opencustomer=function(){wx.openCustomerServiceConversation({showMessageCard:!0,success:function(t){console.log(t)},fail:function(t){console.log(t)}})},n=__decorate([t.Platform(t.TypePlatform.WXGAME)],n)}(t.PMini);t.PWXGame=e,__reflect(e.prototype,"vitamin.PWXGame")}(vitamin||(vitamin={}));var vitamin;!function(t){var e=function(t){function e(e){var n=t.call(this,e)||this;return n._button=e,n._icon=new egret.Bitmap(RES.getRes("ui_json.btn_share")),e.addChild(n._icon),n._icon.y=e.height/2-n._icon.height/2,n._icon.x=e.width-n._icon.width-30,n}return __extends(e,t),e.prototype.initialize=function(){},e.prototype.reset=function(){},e}(egret.EventDispatcher);t.ShareButton=e,__reflect(e.prototype,"vitamin.ShareButton",["vitamin.IAdsButton"])}(vitamin||(vitamin={}));var vitamin;!function(t){var e=function(e){function o(){var t=e.call(this)||this;return t.$name="PBytedance",t}return __extends(o,e),o.prototype.initialize=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return t=this,[4,this.getSystemInfo()];case 1:return t.sysInfo=e.sent(),this.sysInfo&&(this.hostApp=this.sysInfo.appName),this.postMessage("loadAssets",{}),[2,Promise.resolve()]}})})},o.prototype.getSystemInfo=function(){return new Promise(function(t){tt.getSystemInfo({success:function(e){t(e)},fail:function(e){console.log("getSystemInfo 调用失败"),t(null)}})})},o.prototype.get=function(t){return new Promise(function(e){tt.getStorage({key:t,success:function(t){e(t.data)},fail:function(){e(null)}})})},o.prototype.set=function(t,e){return new Promise(function(n){tt.setStorage({key:t,data:e,fail:function(t){return console.error(t)}})})},o.prototype.setToRank=function(e,n,o){var i={wxgame:{score:n,update_time:Date.now()/1e3>>0},ext:JSON.stringify(o)},r=[{key:e,value:JSON.stringify(i)}];return t.log("setUserCloudStorage:",r),wx.setUserCloudStorage({KVDataList:r,success:function(t){console.log("setUserCloudStorage success res: "+t)},fail:function(t){console.log("setImRankData fail res: "+t.errMsg)}}),new Promise(function(t){tt.setImRankData({dataType:0,value:n.toString(),priority:0,extra:JSON.stringify(o),success:function(t){console.log("setImRankData success res: "+t)},fail:function(t){console.log("setImRankData fail res: "+t.errMsg)}})})},o.prototype.showNativeRank=function(t,e){void 0===t&&(t="分"),void 0===e&&(e="排行榜"),console.log("调用tt.getImRankList..."),tt.getImRankList({relationType:"default",dataType:0,rankType:"month",suffix:t,rankTitle:e,success:function(t){console.log("getImRankData success res: "+t)},fail:function(t){console.log("getImRankData fail res: "+t.errMsg)}})},o.prototype.login=function(t,e){return __awaiter(this,void 0,void 0,function(){var n,o=this;return __generator(this,function(i){switch(i.label){case 0:return[4,this.checkSession()];case 1:return n=i.sent(),n?[2,!1]:[2,new Promise(function(n,i){tt.login({success:function(i){o.session||tt.request({url:"https://developer.toutiao.com/api/apps/jscode2session",data:{appid:o.$appId,secret:o.$appSecret,code:i.code,anonymous_code:i.anonymousCode},success:function(t){o.session=t.data,console.log("获取登录信息成功:",t)}}),console.log("login成功: code:"+i.code+", anonymousCode:"+i.anonymousCode),o.setUserGroup(),e&&e.call(t,!0),n(!0)},fail:function(o){console.error("login失败: "+JSON.stringify(o)),e&&e.call(t,!1),n(!1)}})})]}})})},o.prototype.getUserData=function(e){return __awaiter(this,void 0,void 0,function(){var n,o=this;return __generator(this,function(i){switch(i.label){case 0:return e||(e={}),this.userInfo?(e.complete&&e.complete.call(e.caller,this.userInfo),[2,this.userInfo]):[4,this.execAuthorize(t.PMiniAuthSetting.UserInfo)];case 1:return n=i.sent(),n?[3,4]:[4,this.getSetting(t.PMiniAuthSetting.UserInfo)];case 2:return n=i.sent(),n?[3,4]:e.checkSetting?[4,this.execSetting(t.PMiniAuthSetting.UserInfo)]:(tt.showToast({title:"用户信息未获授权,请重新触发授权!",icon:"warn",duration:3e3}),e.complete&&e.complete.call(e.caller,null),[2]);case 3:if(n=i.sent(),!n)return console.error("未成功授权或用户放弃授权!"),tt.showToast({title:"未成功授权或用户放弃授权!",icon:"fail",duration:3e3}),[2];i.label=4;case 4:return[2,new Promise(function(t){tt.getUserInfo({success:function(n){o.ttuserInfo=n.userInfo,o.userInfo={uid:o.session?o.session.openid:null,name:o.ttuserInfo.nickName,headurl:o.ttuserInfo.avatarUrl},console.log("用户信息获取成功:",n.userInfo),e.complete&&e.complete.call(e.caller,o.userInfo),t(o.userInfo)},fail:function(n){console.error("用户信息获取失败!"),tt.showToast({title:"用户信息获取失败...",icon:"fail",duration:3e3}),e.complete&&e.complete.call(e.caller,null),t(null)}})})]}})})},o.prototype.getSetting=function(t){return new Promise(function(e){tt.getSetting({scope:t,success:function(n){console.log("授权设置:",n),tt.showToast({title:"授权设置:"+n.authSetting[t],icon:"none",duration:1e3}),e(n.authSetting[t])},fail:function(t){console.error("获取授权信息失败"),tt.showToast({title:"获取授权信息失败!",icon:"fail",duration:1e3}),e(null)}})})},o.prototype.execSetting=function(t){return new Promise(function(e){tt.openSetting({success:function(n){console.log("用户授权设置:",n),e(n.authSetting[t])},fail:function(){console.error("执行授权失败"),tt.showToast({title:"执行授权失败!",icon:"fail",duration:1e3}),e(null)}})})},o.prototype.execAuthorize=function(t){return new Promise(function(e){tt.authorize({scope:t,success:function(n){console.log("提前授权设置:",n),e("ok"==n.data[t])},fail:function(){console.error("提前授权失败"),tt.showToast({title:"提前授权失败!",icon:"fail",duration:1e3}),e(null)}})})},o.prototype.setUserGroup=function(){tt.setUserGroup({groupId:"world_group",success:function(t){console.log("SetGroup Success!")},fail:function(){console.log("SetGroup Fail!")}})},o.prototype.checkSession=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,new Promise(function(t,e){tt.checkSession({success:function(e){console.log("session未过期"),t(!0)},fail:function(e){console.log("session已过期"),t(!1)}})})]})})},o.prototype.getAccessToken=function(t,e){var n=this;return this._acessToken&&this._acessToken.value&&egret.getTimer()<this._acessToken.invalidTime?void(e&&e.call(t,this._acessToken.value)):void tt.request({url:"ttps://developer.toutiao.com/api/apps/token",data:{appid:this.$appId,secret:this.$appSecret,grant_type:"client_credential"},success:function(o){n._acessToken={value:o.data.access_token,invalidTime:egret.getTimer()+1e3*o.data.expires_in},console.log("获取AccessToken成功!"),e&&e.call(t,n._acessToken.value)},fail:function(n){console.error("获取AccessToken失败!"),e&&e.call(t)}})},o.prototype.uploadData=function(t){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(n){return[2,new Promise(function(n,o){e.getAccessToken(e,function(o){if(!o)return console.error("数据上传失败!"),void n(null);var i={kv_list:t},r=CryptoJS.HmacSHA256(JSON.stringify(i),e.session.session_key).toString();tt.request({url:"https://developer.toutiao.com/api/apps/set_user_storage",method:"POST",data:{access_token:o,openid:e.session.openid,signature:r,sig_method:"hmac_sha256",kv_list:i.kv_list},success:function(t){0==t.errcode?console.log("数据上传成功!"):console.error("数据上传失败:",t)},fail:function(t){console.error("数据上传失败:",t)}})})})]})})},o.prototype.recordStart=function(e){var n=this;this._videoPath="",void 0==e.minduration&&(e.minduration=3e3),void 0==e.maxduration&&(e.maxduration=4e4),void 0==e.clipduration&&(e.clipduration=4e3);var o=tt.getGameRecorderManager();this._clipIndexList||(this._clipIndexList=[]),this._clipIndexList.length=0;var i=egret.getTimer();this._recordLoopId=t.timer.loop(e.clipduration,this,function(){o.recordClip({timeRange:[e.clipduration/1e3,e.clipduration/1e3],success:function(t){n._clipIndexList.push(t.index)}})}),o.onError(function(o){n._recordLoopId&&(t.timer.clearHandler(n._recordLoopId),n._recordLoopId=null),tt.showToast({title:"录屏时产生错误:"+o.errMsg,icon:"fail",duration:1e3}),n.recordState=t.StateRecord.NONE,e&&e.fail&&e.fail.call(e.caller)}),o.onStop(function(o){return n._recordLoopId&&(t.timer.clearHandler(n._recordLoopId),n._recordLoopId=null),egret.getTimer()-i<e.minduration?(t.ui.tip("录屏时间太短,录制无效!"),n.recordState=t.StateRecord.NONE,void(e&&e.fail&&e.fail.call(e.caller))):(n._videoPath=o.videoPath,tt.showToast({title:"视频录制完成!",icon:"success",duration:1e3}),n.recordState=t.StateRecord.RECORDED,void(e&&e.complete&&e.complete.call(e.caller)))}),o.start({duration:e.maxduration/1e3}),this.recordState=t.StateRecord.RECORDING},o.prototype.recordStop=function(){var t=tt.getGameRecorderManager();t.stop()},o.prototype.recordPublish=function(e){var n=this;return this._videoPath?void this.recordClip(this._videoPath).then(function(o){return o?void tt.shareAppMessage({channel:"video",title:e.title,desc:e.desc,imageUrl:e.imageUrl,templateId:e.templateId,query:"",extra:{videoPath:o,videoTopics:e.videoTopics},success:function(){tt.showToast({title:"分享视频成功!",icon:"success",duration:1e3}),n.recordState=t.StateRecord.NONE,e&&e.complete&&e.complete.call(e.caller,!0)},fail:function(t){tt.showToast({title:"分享视频失败:"+t.errMsg,icon:"fail",duration:1e3}),e&&e.fail&&e.fail.call(e.caller,!0)}}):(n.recordState=t.StateRecord.NONE,void(e&&e.fail&&e.fail.call(e.caller,!0)))}):void tt.showToast({title:"没有视频可以分享!",icon:"fail",duration:1e3})},o.prototype.recordClip=function(t){return t&&this._clipIndexList.length?new Promise(function(e){var n=tt.getGameRecorderManager();n.clipVideo({path:t,success:function(t){e(t.videoPath)},fail:function(t){tt.showToast({title:"视频剪辑失败!",icon:"fail",duration:1e3}),e(null)}})}):void tt.showToast({title:"没有视频可以剪辑!",icon:"fail",duration:1e3})
},o.prototype.setRankScore=function(t,e,n,o){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){return this.postMessage("updaterank",{floor:t,score:e}),o&&o.call(n),[2,Promise.resolve()]})})},o.prototype.share=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return tt.shareAppMessage(t),[2,Promise.resolve()]})})},o.prototype.shareInvite=function(){return new Promise(function(t){tt.shareAppMessage({channel:"invite",success:function(e){t(e)}})})},o.prototype.shock=function(){tt.vibrateShort({success:function(t){},fail:function(t){console.log("vibrateShort调用失败")}})},o.prototype.showcustomerButton=function(e,o,i,r){this.hostApp==n.Toutiao&&t.PttCustomerButton.show(e,o,i,r)},o.prototype.hidecustomerButton=function(){this.hostApp==n.Toutiao&&t.PttCustomerButton.hide()},o.prototype.opencustomer=function(){this.hostApp!=n.Toutiao&&tt.openCustomerServiceConversation({type:1,success:function(t){console.log(t)},fail:function(t){console.log(t)}})},o=__decorate([t.Platform(t.TypePlatform.BYTEDANCE)],o)}(t.PMini);t.PBytedance=e,__reflect(e.prototype,"vitamin.PBytedance");var n;!function(t){t.Toutiao="Toutiao",t.Douyin="Douyin",t.news_article_lite="news_article_lite",t.live_stream="live_stream",t.XiGua="XiGua",t.PPX="PPX"}(n=t.PttAppName||(t.PttAppName={}))}(vitamin||(vitamin={}));var vitamin;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.initialize=function(t){return __awaiter(this,void 0,void 0,function(){var n,o=this;return __generator(this,function(i){switch(i.label){case 0:return this.isAvailable?[4,e.prototype.initialize.call(this,t)]:[2,Promise.resolve()];case 1:return i.sent(),n=tt.getSystemInfoSync(),this.$options.bannerId&&(this._banner=tt.createBannerAd({adUnitId:this.$options.bannerId,adIntervals:15,style:{left:.1*n.screenWidth,top:.8*n.screenHeight,width:.8*n.screenWidth}}),this._banner.onLoad(function(){o._bannerLoaded=!0}),this._banner.onError(function(){o._bannerError=!0}),this._banner.onResize(function(t){console.log(t.width,t.height),o._banner.style.top=.8*n.screenHeight,o._banner.style.left=(n.screenWidth-t.width)/2})),[2,Promise.resolve()]}})})},n.prototype.showBanner=function(t,e){var n=this;void 0===t&&(t=.1),void 0===e&&(e=.2),.16>e&&(e=.16),!this._bannerError&&this._banner&&(this._bannerLoaded?this._banner.show():this._banner.onLoad(function(){n._bannerLoaded=!0;var o=tt.getSystemInfoSync();n._banner.style.left=o.screenWidth*t,n._banner.style.top=o.screenHeight*(1-e),n._banner.style.width=o.screenWidth*(1-2*t),n._banner.show()}))},n.prototype.hideBanner=function(){this._banner&&this._banner.hide()},n.prototype.playAdsVideo=function(t,e){return __awaiter(this,void 0,void 0,function(){var n,o,i;return __generator(this,function(r){return void 0==e.retryTimes&&(e.retryTimes=1),n=e.retryTimes,o=function(n){console.log("广告播放完成"),t.offClose(o),n.isEnded?e.sucess&&e.sucess.call(e.caller,n):(e.fail&&e.fail&&e.fail.call(e.caller,n),e.showDefaultToast&&wx.showToast({title:"广告未正常播放完成,无法获得奖励."})),e.complete&&e.complete.call(e.caller,n)},i=function(){t.show().then(function(){console.info("广告显示成功"),t.onClose(o)})["catch"](function(t){console.warn("广告组件出现问题",t),n--,0>=n?(console.warn("广告显示失败",t),e.showDefaultToast&&wx.showToast({title:"广告显示失败,无法获得奖励."}),e.fail&&e.fail&&e.fail.call(e.caller,t),e.complete&&e.complete.call(e.caller,t)):i()})},e.start&&e.start.call(e.caller),i(),[2]})})},n.prototype.loadVideo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.$options.videoId?(this._video&&this._video.destroy(),this._video=tt.createRewardedVideoAd({adUnitId:this.$options.videoId}),[4,this._video.load()]):[2];case 1:return t.sent(),[2]}})})},n.prototype.playVideo=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadVideo()];case 1:return e.sent(),this._video?[4,this.playAdsVideo(this._video,t)]:(t.fail&&t.fail.call(t.caller),t.complete&&t.complete.call(t.caller),[2]);case 2:return e.sent(),[2]}})})},n.prototype.loadInterstitial=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.$options.interstitialId?(this._interstitial&&this._interstitial.destroy(),this._interstitial=tt.createInterstitialAd({adUnitId:this.$options.interstitialId}),[4,this._interstitial.load()]):[2];case 1:return t.sent(),[2]}})})},n.prototype.playInterstitial=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.loadInterstitial(),this._interstitial?[4,this.playAdsVideo(this._interstitial,t)]:(t.fail&&t.fail.call(t.caller),t.complete&&t.complete.call(t.caller),[2]);case 1:return e.sent(),[2]}})})},n.prototype.loadMultitonVideo=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.$options.multitonVideoId?(this._multitonvideo&&this._multitonvideo.destroy(),this._multitonvideo=tt.createRewardedVideoAd({adUnitId:this.$options.multitonVideoId,multiton:!0,multitonRewardMsg:t.reward?[t.reward]:[],multitonRewardTimes:t.times,progressTip:!0}),[4,this._multitonvideo.load()]):[2];case 1:return e.sent(),[2]}})})},n.prototype.playMultitonVideo=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.loadMultitonVideo(t),this._multitonvideo?[4,this.playAdsVideo(this._multitonvideo,t)]:(t.fail&&t.fail.call(t.caller),t.complete&&t.complete.call(t.caller),[2]);case 1:return e.sent(),[2]}})})},Object.defineProperty(n.prototype,"isAvailable",{get:function(){return!!window.tt},enumerable:!0,configurable:!0}),n=__decorate([t.Ads(t.TypePlatform.BYTEDANCE)],n)}(t.ADSBase);t.AdBytedance=e,__reflect(e.prototype,"vitamin.AdBytedance")}(vitamin||(vitamin={}));var vitamin;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n=__decorate([t.Ads(t.TypePlatform.Debug)],n)}(t.ADSBase);t.AdDebug=e,__reflect(e.prototype,"vitamin.AdDebug")}(vitamin||(vitamin={}));var vitamin;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t._isSupported=!1,t}return __extends(n,e),n.prototype.initialize=function(n){return __awaiter(this,void 0,void 0,function(){var o,i,r;return __generator(this,function(a){switch(a.label){case 0:return this.isAvailable?[4,e.prototype.initialize.call(this,n)]:[2,Promise.resolve()];case 1:return a.sent(),o=FBInstant.getSupportedAPIs(),o.indexOf("getInterstitialAdAsync")>=0&&o.indexOf("getRewardedVideoAsync")>=0?this._isSupported=!0:(this._isSupported=!1,t.ui.tip("Ads not supported in this session!",16733525)),i=this,[4,FBInstant.getRewardedVideoAsync(this.$options.videoId)];case 2:return i._video=a.sent(),r=this,[4,FBInstant.getInterstitialAdAsync(this.$options.interstitialId)];case 3:return r._interstitial=a.sent(),[2,Promise.resolve()]}})})},n.prototype.showBanner=function(){},n.prototype.hideBanner=function(){},n.prototype.loadVideo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this._isSupported?[4,this._video.loadAsync()]:[2];case 1:return t.sent(),[2]}})})},n.prototype.playVideo=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this._isSupported?[4,this.loadVideo()]:(t.fail&&t.fail.call(t.caller),t.complete&&t.complete.call(t.caller,!1),[2]);case 1:return e.sent(),[4,this._video.showAsync().then(function(){t.sucess&&t.sucess.call(t.caller,!0),t.complete&&t.complete.call(t.caller,!0)})["catch"](function(e){t.fail&&t.fail.call(t.caller),t.complete&&t.complete.call(t.caller,!1)})];case 2:return e.sent(),[2]}})})},n.prototype.loadInterstitial=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this._isSupported?[4,this._interstitial.loadAsync()]:[2];case 1:return t.sent(),[2]}})})},n.prototype.playInterstitial=function(t){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(n){switch(n.label){case 0:return this._isSupported?[4,this.loadInterstitial()]:(t.fail&&t.fail.call(t.caller),t.complete&&t.complete.call(t.caller,!1),[2]);case 1:return n.sent(),[4,this._interstitial.showAsync().then(function(){e._isInterstitialLoaded=!1,t.sucess&&t.sucess.call(t.caller,!0),t.complete&&t.complete.call(t.caller,!0)})["catch"](function(n){e._isInterstitialLoaded=!1,t.fail&&t.fail.call(t.caller),t.complete&&t.complete.call(t.caller,!1)})];case 2:return n.sent(),[2]}})})},Object.defineProperty(n.prototype,"isAvailable",{get:function(){return!!window.FBInstant},enumerable:!0,configurable:!0}),n=__decorate([t.Ads(t.TypePlatform.FACEBOOK)],n)}(t.ADSBase);t.AdFacebook=e,__reflect(e.prototype,"vitamin.AdFacebook")}(vitamin||(vitamin={}));var vitamin;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),Object.defineProperty(n.prototype,"isAvailable",{get:function(){return!!window.AdMob},enumerable:!0,configurable:!0}),n.prototype.initialize=function(n){return __awaiter(this,void 0,void 0,function(){var o=this;return __generator(this,function(i){switch(i.label){case 0:return this.isAvailable?[4,e.prototype.initialize.call(this,n)]:(t.ui.tip("AdMob没有定义!"),[2,Promise.resolve()]);case 1:return i.sent(),window.AdMob.getAdSettings(function(t){console.log("adId: "+t.adId+"\nadTrackingEnabled: "+t.adTrackingEnabled)},function(){console.log("failed to get user ad settings")}),window.gameConfig.release||t.ui.tip("Ads Test:"+window.gameConfig.adsTest,11184640),window.AdMob.setOptions({position:window.AdMob.AD_POSITION.BOTTOM_CENTER,isTesting:window.gameConfig.adsTest,bgColor:"black"}),document.addEventListener("onAdFailLoad",function(t){"undefined"!=typeof t.originalEvent&&(t=t.originalEvent);var e=t.detail||t.data||t;alert("error: "+e.error+", reason: "+e.reason+", adNetwork:"+e.adNetwork+", adType:"+e.adType+", adEvent:"+e.adEvent)}),document.addEventListener("onAdLoaded",function(t){"undefined"!=typeof t.originalEvent&&(t=t.originalEvent);var e=t.data||t;"interstitial"===e.adType||"rewardvideo"===e.adType}),document.addEventListener("onBannerReceive",function(e){window.gameConfig.release||t.ui.tip("广告载入成功!",11184640)}),document.addEventListener("onBannerFailedToReceive",function(e){window.gameConfig.release||t.ui.tip("广告载入失败!",43520),o.hideBanner()}),document.addEventListener("onBannerPresent",function(e){t.ui.tip("Banner载入成功!",43520)}),document.addEventListener("onBannerLeaveApp",function(e){t.ui.tip("Banner被点击!",43520)}),document.addEventListener("onBannerDismiss",function(e){t.ui.tip("Banner被关闭!",43520)}),document.addEventListener("onInterstitialReceive",function(e){t.ui.tip("插页已载入!",43520)}),document.addEventListener("onInterstitialFailedToReceive",function(e){t.ui.tip("插页载入失败!",11141120),o.hideBanner()}),document.addEventListener("onInterstitialPresent",function(e){t.ui.tip("插页已准备就绪!",43520)}),document.addEventListener("onInterstitialLeaveApp",function(e){t.ui.tip("插页被触发!",43520)}),document.addEventListener("onInterstitialDismiss",function(e){t.ui.tip("插页被关闭!",43520)}),[2,Promise.resolve()]}})})},n.prototype.showBanner=function(){var e=this;if(this.isAvailable&&!this._bannerShowed){if(this._bannerShowed=!0,this._bannerCreated)return void this.updateBananer();window.gameConfig.release||t.ui.tip("正在创建Banner...!",43520),window.AdMob.createBanner({adId:this.$options.videoId,adSize:"SMART_BANNER",offsetTopBar:!1,overlap:!1,position:window.AdMob.AD_POSITION.BOTTOM_CENTER,autoShow:!0},function(){e._bannerCreated=!0,e.updateBananer()})}},n.prototype.hideBanner=function(){},n.prototype.updateBananer=function(){this._bannerCreated&&window.AdMob&&(this._bannerShowed?window.AdMob.showBanner():window.AdMob.hideBanner())},n.prototype.loadVideo=function(){this.isAvailable&&(t.ui.tip("开始预加载奖励视频...",43520),window.AdMob.prepareRewardVideoAd({adId:this.$options.videoId,autoShow:!1},function(){t.ui.tip("开始预加载奖励视频完成.",43520)},function(){t.ui.tip("开始预加载奖励视频失败.",11141120)}))},n.prototype.playVideo=function(e){var n=this;if(this.isAvailable){if(!this._isInspirelLoaded)return void t.ui.tip("奖励视频未加载...",11141120);if(t.ui.tip("开始显示奖励视频...",43520),window.AdMob)return void window.AdMob.showRewardVideoAd(function(){n._isInspirelLoaded=!1,e.sucess&&e.sucess.call(e.caller,!0),e.complete&&e.complete.call(e.caller,!0)},e.fail);e.fail&&e.fail.call(e.caller),e.complete&&e.complete.call(e.caller,!1)}},n.prototype.loadInterstitial=function(){var e=this;this.isAvailable&&(this._isPreInterstitialLoading=!0,t.ui.tip("开始预加载插页...",43520),window.AdMob.prepareInterstitial({adId:this.$options.interstitialId,autoShow:!1},function(){t.ui.tip("开始预加载插页完成.",43520),e._isInterstitialLoaded=!0,e._isPreInterstitialLoading=!1},function(){t.ui.tip("开始预加载插页失败.",11141120),e._isInterstitialLoaded=!1,e._isPreInterstitialLoading=!1}))},n.prototype.playInterstitial=function(e){var n=this;if(this.isAvailable){if(!this._isInterstitialLoaded)return void t.ui.tip("插页未加载...",11141120);if(t.ui.tip("开始显示插页...",43520),window.AdMob)return void window.AdMob.showInterstitial(function(){n._isInterstitialLoaded=!1,e.sucess&&e.sucess.call(e.caller,!0),e.complete&&e.complete.call(e.caller,!0)},e.fail);e.fail&&e.fail.call(e.caller),e.complete&&e.complete.call(e.caller,!1)}},n=__decorate([t.Ads(t.TypePlatform.GOOGLE)],n)}(t.ADSBase);t.AdGoogle=e,__reflect(e.prototype,"vitamin.AdGoogle")}(vitamin||(vitamin={}));var vitamin;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.initialize=function(t){return __awaiter(this,void 0,void 0,function(){var n,o=this;return __generator(this,function(i){switch(i.label){case 0:return this.isAvailable?[4,e.prototype.initialize.call(this,t)]:[2,Promise.resolve()];case 1:return i.sent(),n=wx.getSystemInfoSync(),this.$options.bannerId&&(this._banner=wx.createBannerAd({adUnitId:this.$options.bannerId,adIntervals:15,style:{left:.1*n.screenWidth,top:.8*n.screenHeight,width:.8*n.screenWidth}}),this._banner.onLoad(function(){o._bannerLoaded=!0}),this._banner.onError(function(){o._bannerError=!0}),this._banner.onResize(function(t){console.log(t.width,t.height),o._banner.style.top=.8*n.screenHeight,o._banner.style.left=(n.screenWidth-t.width)/2})),[2,Promise.resolve()]}})})},n.prototype.showBanner=function(t,e){var n=this;void 0===t&&(t=.1),void 0===e&&(e=.2),.16>e&&(e=.16),!this._bannerError&&this._banner&&(this._bannerLoaded?this._banner.show():this._banner.onLoad(function(){n._bannerLoaded=!0;var o=wx.getSystemInfoSync();n._banner.style.left=o.screenWidth*t,n._banner.style.top=o.screenHeight*(1-e),n._banner.style.width=o.screenWidth*(1-2*t),n._banner.show()}))},n.prototype.hideBanner=function(){this._banner&&this._banner.hide()},n.prototype.playAdsVideo=function(t,e){return __awaiter(this,void 0,void 0,function(){var n,o,i,r,a,s=this;return __generator(this,function(c){return void 0==e.retryTimes&&(e.retryTimes=1),n=e.retryTimes,o=function(n){t.offClose(o),n.isEnded?(console.log("广告播放完成"),e.sucess&&e.sucess.call(e.caller,n)):(e.showDefaultToast&&wx.showToast({title:"广告未正常播放完成,无法获得奖励."}),e.fail&&e.fail&&e.fail.call(e.caller,n)),e.complete&&e.complete.call(e.caller,n)},i=function(){console.info("广告显示成功"),t.onClose(o)},r=function(o){n--,0>=n?(console.warn("广告显示失败"),e.showDefaultToast&&wx.showToast({title:"广告显示失败,无法获得奖励."}),e.fail&&e.fail.call(e.caller,o),e.complete&&e.complete.call(e.caller,o)):t.load().then(a.bind(s))["catch"](r.bind(s))},a=function(){t.show().then(i.bind(s))["catch"](r.bind(s))},a(),[2]})})},n.prototype.loadVideo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.$options.videoId?[2]:(this._video&&this._video.destroy(),this._video=wx.createRewardedVideoAd({adUnitId:this.$options.videoId}),[4,this._video.load()]);case 1:return t.sent(),[2]}})})},n.prototype.playVideo=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return this.loadVideo(),this._video?[4,this.playAdsVideo(this._video,e)]:(e.fail&&e.fail.call(e.caller,t.res),e.complete&&e.complete.call(e.caller,t.res),[2]);case 1:return n.sent(),[2]}})})},n.prototype.loadInterstitial=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.$options.interstitialId?[2]:(this._interstitial&&this._interstitial.destroy(),this._interstitial=wx.createInterstitialAd({adUnitId:this.$options.interstitialId}),[4,this._interstitial.load()]);case 1:return t.sent(),[2]}})})},n.prototype.playInterstitial=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return this.loadInterstitial(),this._interstitial?[4,this.playAdsVideo(this._interstitial,e)]:(e.fail&&e.fail.call(e.caller,t.res),e.complete&&e.complete.call(e.caller,t.res),[2]);case 1:return n.sent(),[2]}})})},Object.defineProperty(n.prototype,"isAvailable",{get:function(){return!!window.wx},enumerable:!0,configurable:!0}),n=__decorate([t.Ads(t.TypePlatform.WXGAME)],n)}(t.ADSBase);t.AdWechat=e,__reflect(e.prototype,"vitamin.AdWechat")}(vitamin||(vitamin={}));var vitamin;!function(t){var e=function(e){function n(t,n){var o=e.call(this,t)||this;return o._button=t,o._type=n,o._videoIcon=new egret.Bitmap(RES.getRes("ui_json.icon_video")),t.addChild(o._videoIcon),o._videoIcon.y=t.height/2-o._videoIcon.height/2,o._videoIcon.x=t.width-o._videoIcon.width-10,o._loadingIcon=new egret.Bitmap(RES.getRes("ui_json.icon_video_loading")),t.addChild(o._loadingIcon),o._loadingIcon.anchorOffsetX=o._loadingIcon.texture.textureWidth/2,o._loadingIcon.anchorOffsetY=o._loadingIcon.texture.textureHeight/2,o._loadingIcon.x=o._videoIcon.x+o._videoIcon.width/2,o._loadingIcon.y=o._videoIcon.y+o._videoIcon.height/2,o}return __extends(n,e),n.prototype.initialize=function(){this._button.enabled=!!t.platform,this.updateState()},n.prototype.addlistener=function(){t.platform&&(t.platform.ads.once("INSPIRE_LOADED",this.updateState,this),t.platform.ads.once("INSPIRE_LOAD_ERROR",this.updateState,this))},n.prototype.removelistener=function(){t.platform&&(t.platform.ads.removeEventListener("INSPIRE_LOADED",this.updateState,this),t.platform.ads.removeEventListener("INSPIRE_LOAD_ERROR",this.updateState,this))},n.prototype.updateState=function(){t.platform&&t.ui.tip("视频未在加载中...."),this._button.enabled=!1,this.reset()},n.prototype.reset=function(){this.removelistener(),this._videoIcon.visible=!1,this._loadingIcon.visible=!1,t.ticker.clear(this,this.render)},n.prototype.isLoading=function(){this._videoIcon.visible=!0,this._loadingIcon.visible=!0,this._videoIcon.alpha=.4,t.ticker.add(this,this.render)},n.prototype.isLoadOver=function(){this._videoIcon.visible=!0,this._loadingIcon.visible=!1,this._videoIcon.alpha=1,t.ticker.clear(this,this.render)},n.prototype.render=function(){this._loadingIcon.rotation+=2},n}(egret.EventDispatcher);t.AdsButton=e,__reflect(e.prototype,"vitamin.AdsButton",["vitamin.IAdsButton"])}(vitamin||(vitamin={}));var vitamin;!function(t){var e=function(){function e(){}return e.prototype.show=function(e,n,o,i){var r=e/t.stage.width*window.screen.availWidth,a=n/t.stage.height*window.screen.availHeight,s=o/t.stage.width*window.screen.availWidth,c=i/t.stage.height*window.screen.availHeight;console.log("显示客服按钮:",r,a,s,c);var l=this.button=tt.createContactButton({type:"text",text:"客服",style:{left:r,top:a,width:s,height:c,lineHeight:40,backgroundColor:"#33aaff",textAlign:"center",fontSize:18,borderRadius:4,borderColor:"#114499",borderWidth:1,textColor:"#ffffff"},success:function(t){console.log("create success",t)},fail:function(t){console.log("create fail",t)},complete:function(t){console.log("create complete",t)}});l.show()},e.prototype.hide=function(){console.log("隐藏客服按钮!"),this.button&&(this.button.hide(),this.button.destroy(),this.button=null)},e.show=function(t,n,o,i){this.instance||(this.instance=new e),this.instance.show(t,n,o,i)},e.hide=function(){this.instance&&this.instance.hide()},e}();t.PttCustomerButton=e,__reflect(e.prototype,"vitamin.PttCustomerButton")}(vitamin||(vitamin={}));var vitamin;!function(t){var e=function(){function t(){}return t.decrypt=function(t,e,n){var o=window.CryptoJS;e=o.enc.Base64.parse(e),n=o.enc.Base64.parse(n);var i=o.enc.Base64.stringify(o.enc.Base64.parse(t)),r={iv:n,mode:o.mode.CBC,padding:o.pad.Pkcs7};return o.enc.Utf8.stringify(o.AES.decrypt(i,e,r))},t}();t.AESDecrypt=e,__reflect(e.prototype,"vitamin.AESDecrypt")}(vitamin||(vitamin={}));